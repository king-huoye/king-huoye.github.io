<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">加载中...</title>
    <link rel="stylesheet" href="index.html" type="text/css" media="screen" title="no title" charset="utf-8">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha512-fHwaWebuwA7NSF5Qg/af4UeDx9XqUpYpOGgubo3yWu+b2IQR4UeQwbb42Ti7gVAjNtVoI/I9TEoYeu9omwcC6g==" crossorigin="anonymous">

    <style>
        /* CSS样式与主页卡片风格保持一致，并添加了Markdown渲染后的元素样式。
           这部分CSS是为了确保解析Markdown后生成的HTML元素（如标题、代码块、列表等）
           能有美观的样式。 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            animation: fadeInUp 0.8s ease;
        }

        .header h1 {
            color: white;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.2em;
            margin-bottom: 20px;
        }
        a {
            text-decoration: none;
            color: inherit;
        }
        /* 联系项（按钮样式），在这里作为“返回列表”按钮 */
        .contact-item {
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 25px;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .contact-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        /* 主内容区域，在这里用于显示Markdown渲染后的文章内容 */
        .main-content {
            flex: 1; /* 单列布局 */
            min-width: 0;
            max-width: 900px; /* 限制文章内容的最大宽度，使其更易读 */
            margin: 30px auto; /* 居中 */
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            animation: fadeInUp 0.8s ease;
        }

        /* Markdown渲染后的元素样式 */
        .markdown-body {
            /* 基础文本样式 */
            font-size: 1em;
            line-height: 1.8;
            color: #333;
        }

        .markdown-body h1, .markdown-body h2, .markdown-body h3, .markdown-body h4, .markdown-body h5, .markdown-body h6 {
            color: #333;
            margin-top: 1.5em;
            margin-bottom: 0.8em;
            font-weight: 600;
            padding-bottom: 5px;
            border-bottom: 1px solid rgba(0,0,0,0.1); /* 下划线 */
        }
        .markdown-body h1 { font-size: 2em; border-bottom: 2px solid #667eea; padding-bottom: 10px;}
        .markdown-body h2 { font-size: 1.6em; border-bottom: 1px solid #764ba2; padding-bottom: 8px;}
        .markdown-body h3 { font-size: 1.3em; }

        .markdown-body p {
            margin-bottom: 1em;
        }

        .markdown-body ul, .markdown-body ol {
            margin-left: 25px; /* 列表缩进 */
            margin-bottom: 1em;
        }

        .markdown-body li {
            margin-bottom: 0.5em;
        }

        /* 内联代码样式 */
        .markdown-body code {
            background-color: #f0f0f0;
            border-radius: 4px;
            padding: 2px 5px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace; /* 代码字体 */
            color: #e83e8c; /* 粉色字体 */
        }

        /* 代码块样式 */
        .markdown-body pre {
            background-color: #282c34; /* 深色背景 */
            border-radius: 8px;
            padding: 15px;
            overflow-x: auto; /* 允许水平滚动 */
            margin-bottom: 1em;
        }
        .markdown-body pre code {
            background-color: transparent; /* 继承父级背景 */
            padding: 0;
            color: #abb2bf; /* 浅色字体 */
            white-space: pre-wrap; /* 自动换行 */
            word-wrap: break-word; /* 单词换行 */
        }

        /* 引用块样式 */
        .markdown-body blockquote {
            border-left: 4px solid #667eea; /* 左侧边框 */
            background-color: #f8f8f8;
            padding: 10px 15px;
            margin: 1em 0;
            color: #555;
            font-style: italic;
        }

        /* 表格样式 */
        .markdown-body table {
            width: 100%;
            border-collapse: collapse; /* 合并边框 */
            margin: 1em 0;
        }

        .markdown-body th, .markdown-body td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }

        .markdown-body th {
            background-color: #f2f2f2;
            font-weight: bold;
        }

        /* 图片样式 */
        .markdown-body img {
            max-width: 100%;
            height: auto;
            display: block; /* 块级显示，居中 */
            margin: 1em auto;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        /* 响应式调整 */
        @media (max-width: 768px) {
            .container { padding: 10px; }
            .header { padding: 20px; }
            .header h1 { font-size: 2em; }
            .main-content { padding: 20px; }
        }

        /* 动画 */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1 id="article-title"></h1>
        <p id="article-date"></p>
        <a href="interview-notes.html" class="contact-item">🔙 返回笔记列表</a>
    </div>
</div>

<div class="main-content">
    <div id="markdown-content" class="markdown-body">
        加载中...
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/python.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/javascript.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/bash.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/c.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/cpp.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/java.min.js"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha512-LQNxIMR5rXv7o+b1l8+N1EZMfhG7iFZ9HhnbJkTp4zjNr5Wvst75AqUeFDxeRUa7l5vEDyUiAip//r+EFLLCyA==" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha512-iWiuBS5nt6r60fCz26Nd0Zqe0nbk1ZTIQbl3Kv7kYsX+yKMUFHzjaH2+AnM6vp2Xs+gNmaBAVWJjSmuPw76Efg==" crossorigin="anonymous" onload="renderMathInElement(document.body, {
    // 定义 KaTeX 识别的数学公式分隔符
    delimiters: [
        {left: '$$', right: '$$', display: true},    // 块级公式，例如 $$ \sum_{i=1}^n i $$
        {left: '\\[', right: '\\]', display: true},  // 块级公式，例如 \[ \sum_{i=1}^n i \]
        {left: '$', right: '$', display: false},     // 行内公式，例如 $a^2 + b^2 = c^2$
        {left: '\\(', right: '\\)', display: false} // 行内公式，例如 \(a^2 + b^2 = c^2\)
    ],
    // 允许 KaTeX 渲染未知符号，防止因为不支持的符号导致整个公式不渲染
    throwOnError: false
});"></script>

<script>
    document.addEventListener('DOMContentLoaded', async function() {
        const markdownContentDiv = document.getElementById('markdown-content');
        const pageTitle = document.getElementById('page-title'); // 浏览器标签页标题
        const articleTitle = document.getElementById('article-title'); // 页面内部大标题
        const articleDate = document.getElementById('article-date'); // 页面内部日期

        // 1. 获取 URL 中的查询参数
        const urlParams = new URLSearchParams(window.location.search);
        const noteFileName = urlParams.get('note'); // 获取 ?note= 后面的值

        // 如果没有指定文件名，显示错误信息并退出
        if (!noteFileName) {
            markdownContentDiv.innerHTML = '<p style="color: #d9534f;">❌ 错误：未指定要加载的笔记文件。<br>请检查URL是否包含有效的 "?note=文件名" 参数。</p>';
            pageTitle.textContent = '错误 - 霍烨景的小空间';
            articleTitle.textContent = '加载失败：未指定文件';
            articleDate.textContent = '';
            return;
        }

        // 2. 构造 Markdown 文件的完整路径
        // 假设所有 Markdown 文件都存放在 "notes/" 目录下，文件名是 noteFileName.md
        const markdownFilePath = `notes/${noteFileName}.md`;

        try {
            // 3. 异步加载 Markdown 文件内容
            const response = await fetch(markdownFilePath);

            // 检查HTTP响应状态码，如果不是成功的2xx，则抛出错误
            if (!response.ok) {
                let errorText = `加载失败：文件 "${markdownFilePath}" 不存在或无法访问。`;
                if (response.status === 404) {
                    errorText = `加载失败：文件 "${markdownFilePath}" 未找到 (404)。<br>请检查文件名是否拼写正确（包括大小写），并确认文件是否存在于 'notes/' 目录下。`;
                } else {
                    errorText = `加载失败：服务器返回错误状态码 ${response.status} - ${response.statusText}`;
                }
                markdownContentDiv.innerHTML = `<p style="color: #d9534f;">❌ ${errorText}</p>`;
                pageTitle.textContent = `错误 - ${noteFileName} - 霍烨景的小空间`;
                articleTitle.textContent = '加载失败';
                articleDate.textContent = '';
                console.error("Fetch error:", response); // 打印详细的响应到控制台
                return; // 提前退出函数
            }

            const markdownText = await response.text(); // 获取文件文本内容

            // 4. 配置 marked.js 将 Markdown 转换为 HTML
            marked.setOptions({
                gfm: true, // 启用 GitHub Flavored Markdown (GFM)，支持更多Markdown语法
                breaks: true, // 自动将 Markdown 中的硬回车（换行符）转换为 <br>
                // highlight 函数告诉 marked 在遇到代码块时如何进行高亮
                highlight: function(code, lang) {
                    // 检查 highlight.js 是否支持当前语言，如果不支持则使用纯文本模式
                    const language = hljs.getLanguage(lang) ? lang : 'plaintext';
                    // 使用 highlight.js 对代码进行高亮处理
                    return hljs.highlight(code, { language }).value;
                }
            });

            // 执行Markdown解析
            const htmlContent = marked.parse(markdownText);
            // 将解析后的HTML插入到页面
            markdownContentDiv.innerHTML = htmlContent;

            // 5. 从 Markdown 内容中提取标题和日期，并更新页面标题
            const lines = markdownText.split('\n'); // 将Markdown文本按行分割
            let extractedTitle = ''; // 提取到的标题
            let extractedDate = ''; // 提取到的日期
            let foundTitle = false; // 标记是否已找到标题

            // 遍历Markdown文件的前几行（最多10行），尝试提取标题和日期
            for (let i = 0; i < Math.min(lines.length, 10); i++) {
                const line = lines[i].trim(); // 获取当前行并去除首尾空格

                // 尝试匹配 Markdown 的一级标题 (例如: "# 我的标题")
                const titleMatch = line.match(/^#\s+(.*)/);
                if (titleMatch && titleMatch[1] && !foundTitle) {
                    extractedTitle = titleMatch[1].trim(); // 提取标题文本
                    foundTitle = true; // 标记已找到标题
                }
                // 尝试匹配日期信息 (例如: "Date: 2025年6月28日" 或 "Published: 2025-06-28")
                const dateMatch = line.match(/(?:Date|Published|日期):\s*(.*)/i);
                if (dateMatch && dateMatch[1]) {
                    extractedDate = dateMatch[1].trim(); // 提取日期文本
                }

                // 如果标题和日期都找到了，就停止遍历
                if (foundTitle && extractedDate) {
                    break;
                }
            }

            // 如果从Markdown内容中没有提取到标题，则尝试从文件名生成一个标题
            if (!foundTitle) {
                // 将文件名中的连字符替换为空格，并首字母大写，移除 .md 后缀
                extractedTitle = noteFileName.replace(/-/g, ' ').split('.').slice(0, -1).join(' ').replace(/\b\w/g, l => l.toUpperCase());
            }

            // 更新页面元素的文本内容
            pageTitle.textContent = `${extractedTitle} - 霍烨景的小空间`; // 更新浏览器标签页标题
            articleTitle.textContent = extractedTitle; // 更新页面内部文章大标题
            articleDate.textContent = extractedDate ? `📅 ${extractedDate}` : ''; // 如果有日期则显示，并添加表情符号

        } catch (error) {
            console.error("加载或解析Markdown文件失败:", error); // 打印JS错误到控制台
            // 显示更友好的错误信息给用户
            markdownContentDiv.innerHTML = `<p style="color: #d9534f;">❌ 加载笔记失败。可能原因：文件路径不正确，或者你正在通过 "file://" 协议直接打开文件导致浏览器安全限制。<br>强烈建议使用本地服务器（如 VS Code 的 Live Server 插件）来运行你的网页。</p><p style="color: #d9534f;">详细错误信息: ${error.message}</p>`;
            pageTitle.textContent = '错误 - 霍烨景的小空间';
            articleTitle.textContent = '加载失败';
            articleDate.textContent = '';
        }
    });
</script>
</body>
</html>
